{"version":3,"file":"CrudE.js","sourceRoot":"","sources":["../../../services/CrudE.ts"],"names":[],"mappings":"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","sourcesContent":["import _Ajax from \"./_Ajax\";\r\n//import _BR from \"./_BR\";\r\nimport _Date from \"./_Date\";\r\nimport _Edit from \"./_Edit\";\r\nimport _File from \"./_File\";\r\nimport _Form from \"./_Form\";\r\nimport _Fun from \"./_Fun\";\r\nimport _IHtml from \"./_IHtml\";\r\nimport _IDate from \"./_IDate\";\r\nimport _Input from \"./_Input\";\r\nimport _IText from \"./_IText\";\r\nimport _Json from \"./_Json\";\r\n//import _Me from \"./_Me\";\r\nimport _Prog from \"./_Prog\";\r\nimport _Str from \"./_Str\";\r\nimport _Tool from \"./_Tool\";\r\nimport _Valid from \"./_Valid\";\r\nimport EstrFun from \"./EstrFun\";\r\n//import $ from \"jquery\";\r\n\r\n/**\r\n * crud edit function\r\n * 合併 _edit.js\r\n * 寫入 _me properties:\r\n * fnAfterSwap:\r\n * fnAfterOpenEdit:\r\n * fnUpdateOrViewA: see _updateOrViewA\r\n * divEdit:\r\n * //hasEdit:\r\n * edit0:\r\n * eform0:\r\n * hasChild:\r\n * _nowFun:\r\n * modal:\r\n */\r\nexport default class CrudE {\r\n\r\n    private edits: any; // Assuming edits is passed to the constructor\r\n\r\n    // public properties (matching the function comments)\r\n    public divEdit: JQueryN;\r\n    public edit0: any; // EditOne object\r\n    public eform0: JQuery | null = null; // Master edit form\r\n    public hasChild: boolean = false;\r\n    public _nowFun: string = '';\r\n    public modal: any = null; // For xgOpenModal\r\n\r\n    /**\r\n     * initial crud edit, 寫入 this 變數\r\n     * param1 edits {object Array} for edit form\r\n     * 1.null: means one table, get eform\r\n     * 2.many edit object, if ary0 is null, then call new EditOne()\r\n     * param2 updName {string} update name, default to _BR.Update\r\n     */\r\n    constructor(edits: any) {\r\n        this.edits = edits;\r\n        this._init();\r\n    }\r\n\r\n    private _init(): void {\r\n        this.divEdit = $('#divEdit');\r\n        const hasEdit = (this.divEdit.length > 0);\r\n        if (hasEdit) {\r\n            const Childs = _Edit.Childs;  //constant\r\n            let edit0: any = null;  //master edit object\r\n            if (this.edits == null) {\r\n                // Assuming EditOne is imported or globally available (needs adjustment)\r\n                edit0 = new (window as any).EditOne();\r\n                //this.hasChild = false;\r\n            } else {\r\n                edit0 = (this.edits[0] === null) ? new (window as any).EditOne() : this.edits[0];\r\n                //this.hasChild = edits.length > 1;\r\n                if (this.edits.length > 1) {\r\n                    edit0[Childs] = [];\r\n                    //var childs = this.edits._childs;\r\n                    for (let i = 1; i < this.edits.length; i++)\r\n                        edit0[Childs][i - 1] = this.edits[i];\r\n                }\r\n            }\r\n\r\n            this.edit0 = edit0;\r\n            if (edit0.eform != null)\r\n                this.eform0 = edit0.eform;\r\n            this.hasChild = (_Fun.hasValue(this.edit0[Childs]) && this.edit0[Childs].length > 0);\r\n            //this.editLen = this.edits.length;\r\n            this._initForm(this.edit0);\r\n        }\r\n\r\n        this._nowFun = '';    //now fun of edit0 form\r\n        //this.updName = updName;\r\n\r\n        //for xgOpenModal\r\n        this.modal = null;\r\n\r\n        //3.initial forms(recursive)\r\n        //_prog.init();   //prog path\r\n\r\n        //set _me\r\n        _me.crudE = this;\r\n        _me.edit0 = this.edit0;\r\n        _me.eform0 = this.eform0;\r\n        _me.hasEdit = hasEdit;\r\n        _me.divEdit = this.divEdit;\r\n    }\r\n\r\n    /**\r\n     * initial edit forms(recursive)\r\n     * param edit {object} EditOne/EditMany object\r\n     */\r\n    private _initForm(edit: any): void {\r\n        if (edit.eform == null)\r\n            return;\r\n\r\n        _IDate.init(edit.eform);  //init all date inputs\r\n        edit.validator = _Valid.init(edit.eform);   //set valid variables for _ihtml.js !!\r\n        const childLen = this._getEditChildLen(edit);\r\n        for (let i = 0; i < childLen; i++)\r\n            this._initForm(this._getEditChild(edit, i));\r\n    }\r\n\r\n    //get master edit form\r\n    public getEform0(): JQuery | null {\r\n        return this.edit0.eform;\r\n    }\r\n\r\n    /*\r\n    _getJsonAndSetMode = async function(key, fun) {\r\n        //_me.crudR.toUpdateMode(key);\r\n        var act = (fun == EstrFun.Update) ? 'GetUpdJson' :\r\n            (fun == EstrFun.View) ? 'GetViewJson' : '';\r\n        await _ajax.getJsonA(act, { key: key }, function(data) {\r\n            _me.crudR.toEditMode(fun, data);\r\n        });\r\n    };\r\n     */\r\n\r\n    /**\r\n     * _loadJson -> loadJson\r\n     * load row(include childs) into UI\r\n     */\r\n    public loadJson(json: any): void {\r\n        //load master(single) row\r\n        const edit = this.edit0;\r\n        edit.loadRow(json);\r\n        edit.dataJson = json;\r\n\r\n        //load childs rows(只需載入第一層)\r\n        const childLen = this._getEditChildLen(edit);\r\n        for (let i = 0; i < childLen; i++) {\r\n            const edit2 = this._getEditChild(edit, i);\r\n            edit2.dataJson = this.getChildJson(json, i);\r\n            edit2.loadRows(this.jsonGetRows(edit2.dataJson));\r\n        }\r\n\r\n        //call fnAfterLoadJson() if existed\r\n        //if (_fun.hasValue(edit.fnAfterLoadJson))\r\n        //    edit.fnAfterLoadJson(json);\r\n    }\r\n\r\n    //call fnAfterOpenEdit() if existed\r\n    // _afterOpenEdit -> afterOpen\r\n    public afterOpen(fun: string, json: any): void {\r\n        //if (_fun.hasValue(_me.fnAfterOpenEdit))\r\n        if (_me.fnAfterOpenEdit)\r\n            _me.fnAfterOpenEdit(fun, json);\r\n    }\r\n\r\n    /**\r\n     * _setEditStatus -> setEditStatus\r\n     * set all forms fields edit status\r\n     * param fun {string} C,U,V\r\n     */\r\n    public setEditStatus(fun: string): void {\r\n        //if (fun === this._nowFun)\r\n        //    return;\r\n\r\n        /*\r\n        var isView = (fun == EstrFun.View);\r\n        var run = (isView && this._nowFun != EstrFun.View) ? true :\r\n            (!isView && this._nowFun == EstrFun.View) ? true :\r\n            false;\r\n        */\r\n        //set variables\r\n        this._nowFun = fun;\r\n        //if (!run)\r\n        //    return;\r\n\r\n        const box = this.divEdit!;\r\n        const eform = this.edit0.eform;\r\n        const items = box.find('input, textarea, select, button');\r\n        if (fun == EstrFun.View) {\r\n            _Edit.removeIsNew(eform);\r\n            items.prop('disabled', true)\r\n            box.find('#btnToRead').prop('disabled', false);\r\n            _IHtml.setEdits(box, '', false);\r\n        } else if (fun == EstrFun.Create) {\r\n            _Edit.addIsNew(eform);    //增加_IsNew隱藏欄位\r\n            const dataEdit = '[data-edit=U]';\r\n            items.prop('disabled', false)\r\n            items.filter(dataEdit).prop('disabled', true)\r\n            _IHtml.setEdits(box, '', true);\r\n            _IHtml.setEdits(box, dataEdit, false);\r\n        } else if (fun == EstrFun.Update) {\r\n            _Edit.removeIsNew(eform);\r\n            const dataEdit = '[data-edit=C]';\r\n            items.prop('disabled', false)\r\n            items.filter(dataEdit).prop('disabled', true)\r\n            _IHtml.setEdits(box, '', true);\r\n            _IHtml.setEdits(box, dataEdit, false);\r\n        }\r\n\r\n        //remove span error\r\n        this.divEdit!.find('span.error').remove();\r\n\r\n        //enable btnToRead for view fun\r\n        //if (isView)\r\n        //    box.find('#btnToRead').prop('disabled', false);\r\n    }\r\n\r\n    /**\r\n     * check has upload file or not\r\n     */\r\n    private _hasFile(): boolean {\r\n        const edit = this.edit0;\r\n        if (edit.hasFile)\r\n            return true;\r\n\r\n        const childLen = this._getEditChildLen(edit);\r\n        for (let i = 0; i < childLen; i++) {\r\n            const edit2 = this._getEditChild(edit, i);\r\n            if (edit2.hasFile)\r\n                return true;\r\n        }\r\n\r\n        //case of not found\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * get updated data for save create/update(has _rows, _childs, _deletes, _fileJson)\r\n     * param formData {FormData} for write uploaded files\r\n     * return {json} include fileJson if existed\r\n     */\r\n    private _getUpdJson(formData: FormData): any | null {\r\n        //load master(single) row\r\n        const edit0 = this.edit0;\r\n        const row = edit0.getUpdRow();\r\n        const key = edit0.getKey();\r\n        //var isNew = edit0.isNewRow();\r\n\r\n        //file for master edit\r\n        let fileJson: any = {};\r\n        const levelStr = '0'; //string\r\n        if (edit0.hasFile)\r\n            fileJson = edit0.dataAddFiles(levelStr, formData); //upload files\r\n\r\n        //load child(multiple) rows\r\n        let hasChild = false;\r\n        let childs: any[] = [];\r\n        const childLen = this._getEditChildLen(edit0);\r\n        for (let i = 0; i < childLen; i++) {\r\n            const edit2 = this._getEditChild(edit0, i);\r\n\r\n            //file\r\n            if (edit2.hasFile) {\r\n                const fileJson2 = edit2.dataAddFiles(levelStr + i, formData, edit2.rowsBox); //upload files\r\n                _Json.copy(fileJson2, fileJson);\r\n            }\r\n\r\n            const childJson = edit2.getUpdJson(key);\r\n            if (childJson == null)\r\n                continue;\r\n\r\n            //has child rows\r\n            hasChild = true;\r\n            childs[i] = childJson;\r\n        }\r\n\r\n        let data: any = {};\r\n        let hasData = false;\r\n        if (row != null) {\r\n            hasData = true;\r\n            data[_Edit.Rows] = [row];\r\n        }\r\n        if (hasChild) {\r\n            hasData = true;\r\n            data[_Edit.Childs] = childs;\r\n        }\r\n        if (!_Json.isEmpty(fileJson)) {\r\n            hasData = true;\r\n            data[_Edit.FileJson] = fileJson;\r\n        }\r\n\r\n        if (!hasData)\r\n            return null;\r\n\r\n        //if (!isNew)\r\n        //    data.key = key;\r\n        _Json.removeNull(data);\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * forms validate check, also check systemError\r\n     * return {bool}\r\n     */\r\n    public validAll(): boolean {\r\n        //check system error\r\n        const edit = this.edit0;\r\n        if (_Str.notEmpty(edit.systemError)) {\r\n            _Tool.msg(edit.systemError);\r\n            return false;\r\n        }\r\n\r\n        //validate\r\n        if (!edit.eform.valid())\r\n            return false;\r\n\r\n        //check child Edit\r\n        const childLen = this._getEditChildLen(edit);\r\n        for (let i = 0; i < childLen; i++) {\r\n            //check system error\r\n            const edit2 = this._getEditChild(edit, i);\r\n            if (_Str.notEmpty(edit2.systemError)) {\r\n                _Tool.msg(edit2.systemError);\r\n                return false;\r\n            }\r\n\r\n            //validate\r\n            if (!edit2.valid())\r\n                return false;\r\n        }\r\n\r\n        //case of ok\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * (public) after save\r\n     * data: ResultDto\r\n     */\r\n    public afterSave(data: any): void {\r\n        //debugger;\r\n        //call fnAfterSave if need\r\n        if (_Fun.hasValue(this.edit0.fnAfterSave))\r\n            this.edit0.fnAfterSave();\r\n\r\n        //save no rows\r\n        if (data.Value === '0') {\r\n            _Tool.msg(_BR.SaveNone);\r\n            return;\r\n        }\r\n\r\n        //case of ok\r\n        _Tool.alert(_BR.SaveOk + '(' + data.Value + ')');\r\n\r\n        if (_me.crudR) {\r\n            _me.crudR.dt.reload();\r\n            _me.crudR.toReadMode();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * reset form (recursive)\r\n     * param edit {EditOne}\r\n     */\r\n    private _resetForm(edit: any): void {\r\n        //reset this\r\n        edit.reset();\r\n\r\n        //reset childs\r\n        const childLen = this._getEditChildLen(edit);\r\n        for (let i = 0; i < childLen; i++) {\r\n            const edit2 = this._getEditChild(edit, i);\r\n            edit2.reset();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * check current is create/update mode or not\r\n     */\r\n    public isEditMode(): boolean {\r\n        return (this._nowFun !== EstrFun.View);\r\n    }\r\n\r\n    //return {bool}\r\n    public async _updateOrViewA(fun: string, key: string): Promise<boolean | void> {\r\n        if (_me.fnUpdateOrViewA)\r\n            return await _me.fnUpdateOrViewA(fun, key);\r\n\r\n        const me = this;\r\n        const act = (fun == EstrFun.Update)\r\n            ? 'GetUpdJson' : 'GetViewJson';\r\n        return await _Ajax.getJsonA(act, { key: key }, function (json: any) {\r\n            me.loadJson(json);\r\n            me.setEditStatus(fun);\r\n            me.afterOpen(fun, json);\r\n            _me.crudR.toEditMode(fun);\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * get edit child\r\n     * param edit {object} edit object\r\n     * param childIdx {int} child index, base 0\r\n     */\r\n    private _getEditChild(edit: any, childIdx: number): any {\r\n        return edit[_Edit.Childs][childIdx];\r\n    }\r\n\r\n    /**\r\n     * get edit child len\r\n     * param edit {object} edit object\r\n     */\r\n    private _getEditChildLen(edit: any): number {\r\n        const fid = _Edit.Childs;\r\n        return (edit[fid] == null) ? 0 : edit[fid].length;\r\n    }\r\n\r\n    /**\r\n     * getRowsByJson -> jsonGetRows\r\n     * get rows of json\r\n     * @param {any} json\r\n     * @returns\r\n     */\r\n    public jsonGetRows(json: any): any[] | null {\r\n        return (json == null || json[_Edit.Rows] == null)\r\n            ? null\r\n            : json[_Edit.Rows];\r\n    }\r\n\r\n    //get child json\r\n    //_getChildJson -> getChildJson\r\n    public getChildJson(upJson: any, childIdx: number): any | null {\r\n        const childs = _Edit.Childs;\r\n        return (upJson[childs] == null || upJson[childs].length <= childIdx)\r\n            ? null\r\n            : upJson[childs][childIdx];\r\n    }\r\n\r\n    //get child rows\r\n    public getChildRows(upJson: any, childIdx: number): any[] | null {\r\n        const child = this.getChildJson(upJson, childIdx);\r\n        return this.jsonGetRows(child);\r\n    }\r\n\r\n    /**\r\n     * set child rows\r\n     * param upJson {json}\r\n     * param childIdx {int}\r\n     * param rows {jsons}\r\n     * return {json} child object\r\n     */\r\n    public setChildRows(upJson: any, childIdx: number, rows: any[]): any {\r\n        const fid = _Edit.Childs;\r\n        if (upJson == null)\r\n            upJson = {};\r\n        if (upJson[fid] == null)\r\n            upJson[fid] = [];\r\n        if (upJson[fid].length <= childIdx)\r\n            upJson[fid][childIdx] = {};\r\n\r\n        const child = upJson[fid][childIdx];\r\n        child[_Edit.Rows] = rows;\r\n        return child;\r\n    }\r\n\r\n    /**\r\n     * 將目前畫面資料轉變為新資料\r\n     */\r\n    public editToNew(): void {\r\n        const fun = EstrFun.Create;\r\n        this.setEditStatus(fun);\r\n        this.edit0.resetKey();\r\n        _Prog.setPath(fun);\r\n    }\r\n\r\n    //=== move from _edit.js start\r\n    /**\r\n     * get one updated row for New/Updated\r\n     * 只讀取有異動的欄位\r\n     * called by: EditOne.js, DbAdm MyCrud.js(使用變形的 form !!)\r\n     * param kid {string} key fid\r\n     * param fidTypes {id-value array}\r\n     * param box {object} form object\r\n     * return json row\r\n     */\r\n    public getUpdRow(kid: string, fidTypes: any[], box: JQuery): any | null {\r\n        //case new return row\r\n        const row = _Form.toRow(box);\r\n        if (_Edit.isNewRow(row))\r\n            return row;\r\n        /*\r\n        var key = _input.get(kid, box);\r\n        if (_str.isEmpty(key))\r\n            return row;\r\n        */\r\n\r\n        //case update: 讀取有異動的欄位\r\n        let diff = false;\r\n        const result: any = {};\r\n        let fid: string, ftype: string, value: any, obj: JQuery, old: any;\r\n        for (let j = 0; j < fidTypes.length; j = j + 2) {\r\n            //skip read only type\r\n            ftype = fidTypes[j + 1];\r\n            //if (ftype === 'link' || ftype === 'read')\r\n            //    continue;\r\n\r\n            fid = fidTypes[j];\r\n            //obj = (ftype === 'radio') ? _iradio.getObj(fid, box) : _obj.get(fid, box);\r\n            obj = _Input.getObj(fid, box, ftype);\r\n            //value = _input.getO(obj, box, ftype);\r\n            value = row[fid];\r\n            old = obj.data(_Edit.DataOld);\r\n            //if fully compare, string will not equal numeric !!\r\n            if (value != old) {\r\n                //date/dt old value has more length\r\n                if ((ftype === 'date' || ftype === 'dt') &&\r\n                    _Date.dtsToValue(value) === _Date.dtsToValue(old))\r\n                    continue;\r\n\r\n                result[fid] = value;\r\n                diff = true;\r\n            }\r\n        }\r\n        if (!diff)\r\n            return null;\r\n\r\n        result[kid] = _Input.get(kid, box);\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * getServerFid -> getFileSid\r\n     * get server side variables name for file field\r\n     * param tableId {string}\r\n     * param fid {string} ui file id\r\n     * return {string} format: Table_Fid\r\n     */\r\n    public getFileSid(levelStr: string, fid: string): string {\r\n        return 't' + levelStr + '_' + fid;\r\n    }\r\n\r\n    /**\r\n     * formData set fileJson field\r\n     * param data {formData}\r\n     * param fileJson {json}\r\n     * return void\r\n     */\r\n    public dataSetFileJson(data: FormData, fileJson: any): void {\r\n        if (_Json.isEmpty(fileJson))\r\n            return;\r\n\r\n        const fid = _Edit.FileJson\r\n        if (data.has(fid)) {\r\n            const json = data.get(fid);\r\n            fileJson = _Json.copy(fileJson, json);\r\n        }\r\n        data.set(fid, fileJson);\r\n    }\r\n\r\n    /**\r\n     * onclick viewFile\r\n     * param table {string} table name\r\n     * param fid {string}\r\n     * param elm {element} link element\r\n     * param key {string} row key\r\n     */\r\n    public viewFile(table: string, fid: string, elm: HTMLElement, key: string): void {\r\n        /*\r\n        if (this.isNewKey(key)) {\r\n            _tool.msg(_BR.NewFileNotView);\r\n        } else {\r\n        */\r\n            const ext = _File.getFileExt(elm.innerText);\r\n            if (_File.isImageExt(ext))\r\n                _Tool.showImage(elm.innerHTML, _Str.format('ViewFile?table={0}&fid={1}&key={2}&ext={3}', table, fid, key, ext));\r\n        //}\r\n    }\r\n\r\n    //#region remark code\r\n    //=== move from _edit.js end\r\n    //#endregion\r\n\r\n\r\n    //=== event start ===\r\n    /**\r\n     * onclick Create button\r\n     */\r\n    public onCreate(): void {\r\n        const fun = EstrFun.Create;\r\n        this._resetForm(this.edit0);   //reset first\r\n        this.setEditStatus(fun);\r\n        this.afterOpen(fun, null);\r\n    }\r\n\r\n    /**\r\n     * onclick Update button\r\n     * param key {string} row key\r\n     * return {bool}\r\n     */\r\n    public async onUpdateA(key: string): Promise<boolean | void> {\r\n        _Edit.removeIsNew(this.edit0.eform);    //移除_IsNew隱藏欄位\r\n        return await this._updateOrViewA(EstrFun.Update, key);\r\n    }\r\n\r\n    //return { bool }\r\n    public async onViewA(key: string): Promise<boolean | void> {\r\n        return await this._updateOrViewA(EstrFun.View, key);\r\n    }\r\n\r\n    /**\r\n     * table onclick openModal button(link)\r\n     * param btn {button}\r\n     * param title {string} modal title\r\n     * param fid {string} input field name\r\n     * param required {bool}\r\n     * param maxLen {int}\r\n     */\r\n    public onOpenModal(title: string, fid: string, required: boolean, maxLen: number): void {\r\n        const tr = _Fun.getObj().closest('tr');\r\n        _Tool.showArea(title, _IText.get(fid, tr)!, this.isEditMode(), function(result: string) {\r\n            _IText.set(fid, result, tr);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * on click save, when upload file, server side file variable is t(n)_FieldName\r\n     * below variables are sent to backend\r\n     * key, row(包含_childs, _deletes, _fileNo), files\r\n     */\r\n    public async onSaveA(): Promise<void> {\r\n        //validate all input & system error(will show error msg)\r\n        if (!this.validAll()) {\r\n            _Tool.alert(_BR.InputWrong);\r\n            return;\r\n        }\r\n\r\n        //call fnWhenSave if existed\r\n        const edit0 = this.edit0;\r\n        if (_Fun.hasValue(edit0.fnWhenSave)) {\r\n            const error = edit0.fnWhenSave();\r\n            if (_Str.notEmpty(error)) {\r\n                _Tool.msg(error);\r\n                return;\r\n            }\r\n        }\r\n\r\n        //get saving row\r\n        const formData = new FormData();  //for upload files if need\r\n        const row = this._getUpdJson(formData);\r\n        if (_Json.isEmpty(row)) {\r\n            _Tool.msg(_BR.SaveNone);\r\n            return;\r\n        }\r\n\r\n        //save rows, call backend Save action\r\n        const isNew = edit0.isNewRow();\r\n        const action = isNew ? 'Create' : 'Update';\r\n        let data: any = null;\r\n        const me = this;\r\n        if (this._hasFile()) {\r\n            //has files, use formData\r\n            data = formData;\r\n            data.append('json', _Json.toStr(row));\r\n            if (!isNew)\r\n                data.append('key', edit0.getKey());\r\n\r\n            await _Ajax.getJsonByFdA(action, data, function(result: any) {\r\n                me.afterSave(result);\r\n            });\r\n        } else {\r\n            //no file, use json\r\n            data = { json: _Json.toStr(row) };\r\n            if (!isNew)\r\n                data.key = edit0.getKey();\r\n\r\n            await _Ajax.getJsonA(action, data, function(result: any) {\r\n                me.afterSave(result);\r\n            });\r\n        }\r\n    }\r\n    //=== event end ===\r\n}"]}