{"version":3,"file":"_IDate.js","sourceRoot":"","sources":["../../../base/_IDate.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-nocheck\r\nimport _IBase from \"./_IBase\";\r\nimport _Date from \"./_Date\";\r\nimport _Fun from \"./_Fun\";\r\nimport _Obj from \"./_Obj\";\r\nimport _Str from \"./_Str\";\r\n\r\n/**\r\n * //使用 box 來操作 datepicker !!\r\n * //for date input (bootstrap-datepicker)\r\n * //_idt drive from _idate\r\n */\r\nexport default class _IDate extends _IBase {\r\n\r\n    //find box, 同時用來執行日期欄位初始化\r\n    static BoxFilter: string = '.date';\r\n\r\n    //=== get/set start ===\r\n    /**\r\n     * get ymd with format _fun.MmDateFmt\r\n     * param obj {object} date input object\r\n     * return mm date\r\n     */\r\n    static getO(obj: JQuery): string {\r\n        return _Date.uiToMmDate(obj.val() as string);\r\n    }\r\n\r\n    /**\r\n     * set input value\r\n     * param obj {object} date input object\r\n     * param value {string} format: _fun.MmDateFmt\r\n     */\r\n    static setO(obj: JQuery, value: string): void {\r\n        //_idate._boxSetDate(_idate._objToBox(obj), _date.dtsToFormat(value));\r\n        _IDate._boxSetDate(_IDate._objToBox(obj), value);\r\n    }\r\n\r\n    /**\r\n     * set edit status\r\n     * param obj {object} date input object\r\n     */\r\n    static setEditO(obj: JQuery, status: boolean): void {\r\n        obj.prop('disabled', !status);\r\n    }\r\n\r\n    /**\r\n     * initial, called by _me.crudE.js\r\n     * param box {object}\r\n     * param fid {string} optional\r\n     */\r\n    static init(box: JQuery, fid?: string): void {\r\n        const obj = _Str.isEmpty(fid)\r\n            ? box.find(_IDate.BoxFilter)\r\n            : _Obj.get(fid!, box).closest(_IDate.BoxFilter);\r\n        if (obj.length == 0)\r\n            return;\r\n\r\n        //initial\r\n        // Assuming datepicker is a jQuery plugin attached to the JQuery object\r\n        (obj as any).datepicker({\r\n            //format in bootstrap-datepicker.js\r\n            language: _Fun.locale,\r\n            autoclose: true,\r\n            showOnFocus: false,\r\n            todayHighlight: true,   // 高亮顯示今天的日期\r\n            //startDate: '-3d'\r\n        }).on('changeDate', function (e: any) {\r\n            //datepicker(使用box)和 validation(使用input)是2個不同的機制\r\n            //$(this).focus();\r\n            //$(this).valid();\r\n            //var aa = 'aa';\r\n            _IDate._boxGetInput($(this)).valid();\r\n            //$(_idate).datepicker('hide');\r\n            //傳入 fid, value\r\n            /* temp remark\r\n            if (fnOnChange !== undefined) {\r\n                var me = $(this);\r\n                var fid = _str.notEmpty(me.attr('id')) ? me.attr('id') : me.data('id');\r\n                fnOnChange(fid, me.val());\r\n            }\r\n            */\r\n        });\r\n\r\n        //stop event, or it will popup when reset(jquery 3.21) !!\r\n        obj.find('.input-group-addon').off('click');\r\n    }\r\n\r\n    //show/hide datepicker\r\n    static onToggle(): void {\r\n        const btn = _Fun.getMe();\r\n        //$(btn).parent().parent().find('input').trigger('focus');\r\n        _IDate._elmToBox(btn).datepicker('show');\r\n    }\r\n\r\n    //reset value\r\n    static onReset(): void {\r\n        //check input status first\r\n        const btn = _Fun.getMe();\r\n        const box = _IDate._elmToBox(btn);\r\n        const input = _IDate._boxGetInput(box);\r\n        if (_IDate.getEditO(input)) {\r\n            _IDate._boxSetDate(box, '');\r\n            //input.trigger('change');\r\n        }\r\n    }\r\n\r\n    //get edit status, return bool\r\n    static getEditO(obj: JQuery): boolean {\r\n        return !obj.is(':disabled');\r\n    }\r\n\r\n    //=== private function below ===\r\n    /**\r\n     * input element to date box\r\n     * return {object}\r\n     */\r\n    static _elmToBox(elm: HTMLElement): JQuery {\r\n        return _IDate._objToBox($(elm));\r\n    }\r\n\r\n    static _objToBox(obj: JQuery): JQuery {\r\n        return obj.closest(_IDate.BoxFilter);\r\n    }\r\n\r\n    static _boxSetDate(box: JQuery, date: string): void {\r\n        box.datepicker('update', date);\r\n        //var input = _idate._boxGetInput(box);\r\n        //input.datepicker('update', date);\r\n        // 手動觸發 changeDate 事件\r\n        box.trigger({\r\n            type: 'changeDate',\r\n            date: date // 獲取更新後的日期物件\r\n        });\r\n        //box.datepicker('update', '2024-12-30');\r\n        //box.val().datepicker('update', date('2024-12-25'));\r\n    }\r\n\r\n    static _boxGetInput(box: JQuery): JQuery {\r\n        return box.find('input');\r\n    }\r\n\r\n} //class"]}